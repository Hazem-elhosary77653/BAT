# ğŸ—ï¸ System Architecture & Diagrams

**Project:** Business Analyst Assistant Tool  
**Generated:** January 4, 2026  
**Version:** 1.0  

---

## 1. SYSTEM ARCHITECTURE OVERVIEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       USER INTERFACE LAYER                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Dashboard  â”‚  â”‚  User       â”‚  â”‚  Reports    â”‚             â”‚
â”‚  â”‚             â”‚  â”‚  Stories    â”‚  â”‚             â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  BRD Mgmt   â”‚  â”‚  Templates  â”‚  â”‚  Diagrams   â”‚             â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Documents  â”‚  â”‚  AI Config  â”‚  â”‚  Settings   â”‚             â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â”‚                    (Next.js + React + Tailwind)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API GATEWAY LAYER                           â”‚
â”‚                     (Express.js Router)                          â”‚
â”‚                                                                  â”‚
â”‚  Auth | Stories | BRD | Templates | Documents | AI | Azure      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BUSINESS LOGIC LAYER                          â”‚
â”‚                   (Express.js Controllers)                       â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Auth          â”‚  â”‚Story         â”‚  â”‚BRD           â”‚          â”‚
â”‚  â”‚Controller    â”‚  â”‚Controller    â”‚  â”‚Controller    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Template      â”‚  â”‚Document      â”‚  â”‚AI            â”‚          â”‚
â”‚  â”‚Controller    â”‚  â”‚Controller    â”‚  â”‚Controller    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚Settings      â”‚  â”‚Azure DevOps  â”‚                            â”‚
â”‚  â”‚Controller    â”‚  â”‚Controller    â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVICE LAYER                              â”‚
â”‚                  (Business Logic Abstraction)                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚User Service  â”‚  â”‚Story Service â”‚  â”‚AI Service    â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚- Profile     â”‚  â”‚- CRUD        â”‚  â”‚- Prompts     â”‚          â”‚
â”‚  â”‚- 2FA         â”‚  â”‚- Validation  â”‚  â”‚- OpenAI Call â”‚          â”‚
â”‚  â”‚- Sessions    â”‚  â”‚- Linking     â”‚  â”‚- Caching     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Template Svc  â”‚  â”‚Document Svc  â”‚  â”‚Azure Svc     â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚- CRUD        â”‚  â”‚- Upload      â”‚  â”‚- Auth        â”‚          â”‚
â”‚  â”‚- Categories  â”‚  â”‚- Search      â”‚  â”‚- Sync        â”‚          â”‚
â”‚  â”‚- Sharing     â”‚  â”‚- Preview     â”‚  â”‚- Link        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA ACCESS LAYER                            â”‚
â”‚              (Database Queries & Transactions)                   â”‚
â”‚                                                                  â”‚
â”‚  SQLite Query Manager | Connection Pool | Migrations            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE LAYER                             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         SQLite Database (database.db)                    â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Tables:                                                 â”‚  â”‚
â”‚  â”‚  - users              - user_sessions                    â”‚  â”‚
â”‚  â”‚  - user_groups        - group_members                    â”‚  â”‚
â”‚  â”‚  - user_stories       - brd_documents                    â”‚  â”‚
â”‚  â”‚  - templates          - documents                        â”‚  â”‚
â”‚  â”‚  - diagrams           - audit_logs                       â”‚  â”‚
â”‚  â”‚  - ai_configurations  - azure_devops_connections         â”‚  â”‚
â”‚  â”‚  - password_reset_tokens - user_settings                â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. EXTERNAL INTEGRATIONS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Business Analyst Tool                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenAI API  â”‚  â”‚ Azure DevOps â”‚  â”‚   File CDN   â”‚
â”‚              â”‚  â”‚     APIs     â”‚  â”‚  (Uploads)   â”‚
â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
â”‚ - GPT-4      â”‚  â”‚ - Work Items â”‚  â”‚ - Documents  â”‚
â”‚ - GPT-3.5    â”‚  â”‚ - Projects   â”‚  â”‚ - BRDs       â”‚
â”‚ - Embedding  â”‚  â”‚ - PAT Auth   â”‚  â”‚ - Diagrams   â”‚
â”‚              â”‚  â”‚ - REST API   â”‚  â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. DATA FLOW DIAGRAMS

### 3.1 User Story Creation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 USER STORY CREATION FLOW                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Manual Creation Path:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User                Frontend              Backend             Database
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Open Story       â”‚                    â”‚                   â”‚
  â”‚  Creation Form    â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Fill Details     â”‚                    â”‚                   â”‚
  â”‚  (Title, Desc,    â”‚                    â”‚                   â”‚
  â”‚   Criteria)       â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Click Create     â”‚                    â”‚                   â”‚
  â”‚                   â”œâ”€ POST /stories â”€â”€â”€â”€â”¤                   â”‚
  â”‚                   â”‚  (payload)          â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ Validate Data    â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ Generate ID      â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ INSERT into      â”‚
  â”‚                   â”‚                    â”‚  user_stories  â”€â”€â”€â”¼â”€â”€â”
  â”‚                   â”‚                    â”‚                   â”‚  â”‚
  â”‚                   â”‚  â—„â”€ Response â—„â”€â”€â”€â”€â”¤                   â”‚  â”‚
  â”‚                   â”‚  (success + ID)     â”‚                   â”‚  â”‚
  â”‚                   â”‚                    â”œâ”€ Log Action â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”
  â”‚                   â”‚                    â”‚  in audit_logs   â”‚  â”‚  â”‚
  â”‚â—„â”€ Success Msg â—„â”€â”€â”€â”¤                    â”‚                   â”‚  â”‚  â”‚
  â”‚  + Redirect      â”‚                    â”‚                   â”‚  â”‚  â”‚


AI Generation Path:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User                Frontend              Backend             OpenAI
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Paste Req.       â”‚                    â”‚                   â”‚
  â”‚  (from doc)       â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Click Generate   â”‚                    â”‚                   â”‚
  â”‚  Stories with AI  â”‚                    â”‚                   â”‚
  â”‚                   â”œâ”€ POST /ai/...      â”‚                   â”‚
  â”‚                   â”‚  generate-stories â”¤                   â”‚
  â”‚                   â”‚                    â”œâ”€ Build Prompt â”€â”€â”€â”€â”¤
  â”‚                   â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ Call OpenAI API  â”‚
  â”‚                   â”‚                    â”‚  (GPT-4)       â”€â”€â”€â”¼â”€ Generate
  â”‚                   â”‚                    â”‚                   â”‚  Stories
  â”‚                   â”‚                    â”‚  â—„â”€ Response   â—„â”€â”€â”¤
  â”‚                   â”‚                    â”‚  (JSON Stories)   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”‚                   â”‚  â—„â”€ Preview â—„â”€â”€â”€â”€â”¤                   â”‚
  â”‚                   â”‚  (generated stories)                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Review Generated â”‚                    â”‚                   â”‚
  â”‚  Stories          â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Click Save All   â”‚                    â”‚                   â”‚
  â”‚                   â”œâ”€ POST /stories/bulkâ”€â”€â”€â”€â”€â”€â”             â”‚
  â”‚                   â”‚  (array of stories)â”‚      â”‚             â”‚
  â”‚                   â”‚                    â”œâ”€ For each:        â”‚
  â”‚                   â”‚                    â”‚  - Validate       â”‚
  â”‚                   â”‚                    â”‚  - Generate ID    â”‚
  â”‚                   â”‚                    â”‚  - INSERT â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
  â”‚                   â”‚                    â”‚    Multiple rows  â”‚    â”‚
  â”‚                   â”‚  â—„â”€ Success â—„â”€â”€â”€â”€â”¤                   â”‚    â”‚
  â”‚                   â”‚  (N stories saved) â”‚                   â”‚    â”‚
  â”‚                   â”‚                    â”œâ”€ Log Batch â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”
  â”‚â—„â”€ Success Msg â—„â”€â”€â”€â”¤                    â”‚  Creation        â”‚    â”‚  â”‚
  â”‚  View All Stories â”‚                    â”‚                   â”‚    â”‚  â”‚
  â”‚                   â”‚                    â”‚                   â”‚    â”‚  â”‚
```

### 3.2 BRD Generation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BRD GENERATION FROM STORIES FLOW                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User                Frontend              Backend             AI/DB
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Navigate to      â”‚                    â”‚                   â”‚
  â”‚  BRD Manager      â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Click "Generate  â”‚                    â”‚                   â”‚
  â”‚  BRD from         â”‚                    â”‚                   â”‚
  â”‚  Stories"         â”‚                    â”‚                   â”‚
  â”‚                   â”œâ”€ GET /stories â”€â”€â”€â”€â”¤                   â”‚
  â”‚                   â”‚  (all stories)     â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ Query DB â”€â”€â”€â”€â”€â”€â”€â”¬â”¤
  â”‚                   â”‚                    â”‚  user_stories    â”‚â”‚
  â”‚                   â”‚  â—„â”€ List Stories â—„â”¤                   â”‚â”‚
  â”‚                   â”‚  (checkbox list)   â”‚                   â”‚â””â”€â”
  â”‚                   â”‚                    â”‚                   â”‚  â”‚
  â”œâ”€ Select Stories   â”‚                    â”‚                   â”‚  â”‚
  â”‚  + Choose         â”‚                    â”‚                   â”‚  â”‚
  â”‚  Template         â”‚                    â”‚                   â”‚  â”‚
  â”‚                   â”‚                    â”‚                   â”‚  â”‚
  â”œâ”€ Click Generate   â”‚                    â”‚                   â”‚  â”‚
  â”‚                   â”œâ”€ POST /brd/......  â”‚                   â”‚  â”‚
  â”‚                   â”‚  generate â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚  â”‚
  â”‚                   â”‚  (selected story   â”‚                   â”‚  â”‚
  â”‚                   â”‚   IDs + template)  â”‚                   â”‚  â”‚
  â”‚                   â”‚                    â”œâ”€ Fetch Selected â”€â”€â”¼â”€â”€â”˜
  â”‚                   â”‚                    â”‚  Stories from DB  â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”‚                   â”‚ "Generating..." â”‚  â”œâ”€ Build AI Prompt â”‚
  â”‚                   â”‚ (progress)      â”‚  â”‚  (stories + tmpl) â”‚
  â”‚                   â”‚                   â”‚                   â”‚
  â”‚                   â”‚                   â”œâ”€ Call OpenAI API  â”‚
  â”‚                   â”‚                   â”‚  (GPT-4) â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                   â”‚                   â”‚                   â”‚
  â”‚                   â”‚                   â”‚  â—„â”€ Response   â—„â”€â”€â”¤
  â”‚                   â”‚                   â”‚  (Full BRD text)  â”‚
  â”‚                   â”‚                   â”‚                   â”‚
  â”‚                   â”‚ â—„â”€ Show Preview â—„â”¤ â”œâ”€ Parse Response  â”‚
  â”‚                   â”‚ (BRD in modal)     â”‚ â””â”€ Format         â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Review BRD       â”‚                    â”‚                   â”‚
  â”‚                   â”‚                    â”‚                   â”‚
  â”œâ”€ Click "Save"     â”‚                    â”‚                   â”‚
  â”‚                   â”œâ”€ POST /brd/save â”€â”€â”¤                   â”‚
  â”‚                   â”‚  (BRD content)     â”‚                   â”‚
  â”‚                   â”‚                    â”œâ”€ Validate â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚                   â”‚                    â”œâ”€ Generate ID     â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚                   â”‚                    â”œâ”€ INSERT to â”€â”€â”€â”€â”€â”€â”¼â”€â”
  â”‚                   â”‚                    â”‚  brd_documents    â”‚  â”‚
  â”‚                   â”‚                    â”‚                  â”‚  â”‚
  â”‚                   â”‚  â—„â”€ Success â—„â”€â”€â”€â”€â”¤ â”œâ”€ Log in audit â”€â”€â”¼â”€â”¼â”
  â”‚â—„â”€ Saved! Msg â—„â”€â”€â”€â”¤                    â”‚  _logs            â”‚  â”‚â”‚
  â”‚ + Export Options  â”‚                    â”‚                   â”‚  â”‚â”‚
  â”‚                   â”‚                    â”‚                   â”‚  â”‚â”‚
  â”œâ”€ Click "Export    â”‚                    â”‚                   â”‚  â”‚â”‚
  â”‚  as PDF"          â”‚                    â”‚                   â”‚  â”‚â”‚
  â”‚                   â”œâ”€ POST /brd/..      â”‚                   â”‚  â”‚â”‚
  â”‚                   â”‚  export/pdf â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚  â”‚â”‚
  â”‚                   â”‚  (BRD ID)          â”‚                   â”‚  â”‚â”‚
  â”‚                   â”‚                    â”œâ”€ Query BRD â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”˜â”‚
  â”‚                   â”‚                    â”‚  from DB          â”‚   â”‚
  â”‚                   â”‚                    â”‚                   â”‚   â”‚
  â”‚                   â”‚                    â”œâ”€ Generate PDF     â”‚   â”‚
  â”‚                   â”‚                    â”‚  with PDFKit      â”‚   â”‚
  â”‚                   â”‚                    â”‚                   â”‚   â”‚
  â”‚                   â”‚  â—„â”€ PDF File â—„â”€â”€â”€â”¤                   â”‚   â”‚
  â”‚â—„â”€ Download File â—„â”¤                    â”‚                   â”‚   â”‚
  â”‚                   â”‚                    â”‚                   â”‚   â”‚
```

### 3.3 Azure DevOps Sync Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AZURE DEVOPS SYNC FLOW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User              Frontend              Backend            Azure DevOps
  â”‚                  â”‚                   â”‚                   â”‚
  â”œâ”€ Click Sync     â”‚                   â”‚                   â”‚
  â”‚ with Azure      â”‚                   â”‚                   â”‚
  â”‚ DevOps          â”‚                   â”‚                   â”‚
  â”‚                 â”œâ”€ POST /azure/sync â”œâ”€ Get Connection â”â”‚
  â”‚                 â”‚                   â”‚ (org, PAT)      â”‚
  â”‚                 â”‚                   â”‚                 â”‚
  â”‚"Syncing..." â”‚  â”œâ”€ Query All Work â”€â”€â”€â”¼â”€ GET /...      â”¤
  â”‚             â”‚  â”‚  Items API         â”‚  workitems  â”€â”€â”€â”¼â”€ Fetch Items
  â”‚             â”‚  â”‚                    â”‚                 â”‚
  â”‚             â”‚  â”‚                    â”‚ â—„â”€ Work Items â—„â”€â”¤
  â”‚             â”‚  â”‚                    â”‚ (JSON array)    â”‚
  â”‚             â”‚  â”‚                    â”‚                 â”‚
  â”‚             â”‚  â”‚                    â”œâ”€ For Each Item: â”‚
  â”‚             â”‚  â”‚                    â”‚ - Map fields    â”‚
  â”‚             â”‚  â”‚                    â”‚ - Check local   â”‚
  â”‚             â”‚  â”‚                    â”‚ - Detect        â”‚
  â”‚             â”‚  â”‚                    â”‚   conflicts     â”‚
  â”‚             â”‚  â”‚                    â”‚                 â”‚
  â”‚             â”‚  â”‚                    â”œâ”€ Create/Update  â”‚
  â”‚             â”‚  â”‚                    â”‚  local stories â”€â”¼â”€â”
  â”‚             â”‚  â”‚                    â”‚                 â”‚  â”‚
  â”‚             â”‚  â”‚                    â”œâ”€ Store mapping  â”‚  â”‚
  â”‚             â”‚  â”‚                    â”‚  in azure_wi_mapâ”‚  â”‚
  â”‚             â”‚  â”‚                    â”‚                 â”‚  â”‚
  â”‚             â”‚  â”‚ â—„â”€ Sync Results â—„â”€â”¤                 â”‚  â”‚
  â”‚             â”‚  â”‚ (stats, conflicts) â”‚                 â”‚  â”‚
  â”‚             â”‚  â”‚                    â”œâ”€ Log all   â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”
  â”‚â—„â”€ Results â—„â”€â”¤                    â”‚  changes        â”‚  â”‚  â”‚
  â”‚ Dialog      â”‚                    â”‚                 â”‚  â”‚  â”‚
  â”‚ - 5 synced â”‚                    â”‚                 â”‚  â”‚  â”‚
  â”‚ - 2 new    â”‚                    â”‚                 â”‚  â”‚  â”‚
  â”‚ - 1 conflict                     â”‚                 â”‚  â”‚  â”‚
  â”‚            â”‚                    â”‚                 â”‚  â”‚  â”‚
```

---

## 4. DATABASE SCHEMA DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE SCHEMA                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AUTHENTICATION & USERS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

users (id, email, username, mobile, password_hash, role, 
       first_name, last_name, avatar_url, created_at, updated_at)
  â”‚
  â”œâ”€ has many â†’ user_sessions
  â”œâ”€ has many â†’ user_groups (through group_members)
  â”œâ”€ has many â†’ user_stories
  â”œâ”€ has many â†’ user_settings
  â””â”€ has many â†’ audit_logs

user_sessions (id, user_id, token, ip_address, user_agent, 
               login_time, last_activity, is_active, expires_at)

user_groups (id, name, description, created_by, created_at)
  â”‚
  â””â”€ has many â†’ group_members

group_members (id, group_id, user_id, role, joined_at)


CORE FEATURES:
â•â•â•â•â•â•â•â•â•â•â•â•â•

user_stories (id, user_id, title, description, acceptance_criteria,
              priority, status, tags, created_at, updated_at,
              azure_work_item_id)
  â”‚
  â”œâ”€ has many â†’ brd_documents
  â”œâ”€ has many â†’ comments
  â””â”€ belongs to â†’ user_groups (if team-owned)

brd_documents (id, user_id, title, content, version, created_at,
               updated_at, exported_format)
  â”‚
  â”œâ”€ has many â†’ brd_versions
  â””â”€ belongs to â†’ user_stories (many-to-many)

brd_versions (id, brd_id, content, version_number, created_by,
              created_at, change_notes)

templates (id, name, category, description, content, created_by,
           visibility, created_at, updated_at, usage_count)
  â”‚
  â””â”€ has many â†’ template_usage

template_usage (id, template_id, used_by, used_at, context)

documents (id, user_id, file_name, file_path, file_size, file_type,
           uploaded_at, description)
  â”‚
  â””â”€ has many â†’ document_versions

document_versions (id, document_id, file_path, version_number,
                  created_at, uploaded_by)

diagrams (id, user_id, title, diagram_type, content, created_at,
          updated_at)
  â”‚
  â””â”€ has many â†’ diagram_versions

diagram_versions (id, diagram_id, content, version_number, created_at)

reports (id, user_id, title, report_type, data, created_at)


CONFIGURATION & INTEGRATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ai_configurations (id, user_id, api_key, model, temperature,
                  max_tokens, language, detail_level, created_at,
                  updated_at)

azure_devops_connections (id, user_id, org_url, project_id,
                         project_name, pat, connected_at,
                         last_sync_at, sync_status)

azure_work_items_mapping (id, local_story_id, azure_item_id,
                         azure_item_type, last_synced_at,
                         sync_status, azure_data)

brd_azure_links (id, brd_id, azure_item_id, linked_at, linked_by)


SYSTEM:
â•â•â•â•â•

user_settings (id, user_id, settings_json, created_at, updated_at)

password_reset_tokens (id, user_id, token, expires_at, used_at)

audit_logs (id, user_id, action, resource_type, resource_id,
           changes, created_at, ip_address)


RELATIONSHIP SUMMARY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ user_sessions
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ user_stories
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ brd_documents
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ templates
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ documents
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ diagrams
users â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ audit_logs

user_stories â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ brd_documents
brd_documents â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ brd_versions
documents â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ document_versions
diagrams â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ diagram_versions
templates â”€â”€â”€â”€ (1:many) â”€â”€â”€â”€ template_usage
```

---

## 5. API ENDPOINTS HIERARCHY

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           REST API ENDPOINT STRUCTURE               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/api
â”œâ”€â”€ /auth
â”‚   â”œâ”€â”€ POST   /register
â”‚   â”œâ”€â”€ POST   /login
â”‚   â”œâ”€â”€ POST   /logout
â”‚   â”œâ”€â”€ POST   /refresh-token
â”‚   â””â”€â”€ POST   /forgot-password
â”‚
â”œâ”€â”€ /profile
â”‚   â”œâ”€â”€ GET    /me
â”‚   â”œâ”€â”€ PUT    /me
â”‚   â””â”€â”€ POST   /change-password
â”‚
â”œâ”€â”€ /user-stories
â”‚   â”œâ”€â”€ GET    /                (list with filters)
â”‚   â”œâ”€â”€ POST   /                (create)
â”‚   â”œâ”€â”€ GET    /:id             (get one)
â”‚   â”œâ”€â”€ PUT    /:id             (update)
â”‚   â”œâ”€â”€ DELETE /:id             (delete)
â”‚   â””â”€â”€ POST   /:id/link-azure  (link to Azure)
â”‚
â”œâ”€â”€ /brd
â”‚   â”œâ”€â”€ GET    /                (list BRDs)
â”‚   â”œâ”€â”€ GET    /:id             (get BRD content)
â”‚   â”œâ”€â”€ POST   /generate        (generate from stories)
â”‚   â”œâ”€â”€ PUT    /:id             (update content)
â”‚   â”œâ”€â”€ POST   /:id/export      (export PDF/DOCX)
â”‚   â”œâ”€â”€ GET    /:id/versions    (version history)
â”‚   â””â”€â”€ POST   /:id/link-azure  (link to work item)
â”‚
â”œâ”€â”€ /templates
â”‚   â”œâ”€â”€ GET    /                (list templates)
â”‚   â”œâ”€â”€ POST   /                (create template)
â”‚   â”œâ”€â”€ GET    /:id             (get template)
â”‚   â”œâ”€â”€ PUT    /:id             (update template)
â”‚   â”œâ”€â”€ DELETE /:id             (delete template)
â”‚   â””â”€â”€ POST   /:id/use         (record usage)
â”‚
â”œâ”€â”€ /documents
â”‚   â”œâ”€â”€ GET    /                (list documents)
â”‚   â”œâ”€â”€ POST   /upload          (upload file)
â”‚   â”œâ”€â”€ GET    /:id             (get document)
â”‚   â”œâ”€â”€ GET    /:id/preview     (get preview)
â”‚   â”œâ”€â”€ DELETE /:id             (delete)
â”‚   â””â”€â”€ POST   /search          (full-text search)
â”‚
â”œâ”€â”€ /diagrams
â”‚   â”œâ”€â”€ GET    /                (list diagrams)
â”‚   â”œâ”€â”€ POST   /                (create diagram)
â”‚   â”œâ”€â”€ GET    /:id             (get diagram)
â”‚   â”œâ”€â”€ PUT    /:id             (update diagram)
â”‚   â”œâ”€â”€ DELETE /:id             (delete)
â”‚   â”œâ”€â”€ POST   /:id/export      (export PNG/SVG/PDF)
â”‚   â””â”€â”€ GET    /:id/versions    (version history)
â”‚
â”œâ”€â”€ /reports
â”‚   â”œâ”€â”€ GET    /                (list reports)
â”‚   â”œâ”€â”€ GET    /:id             (get report)
â”‚   â”œâ”€â”€ POST   /:id/export-pdf  (export PDF)
â”‚   â”œâ”€â”€ POST   /:id/export-excel(export Excel)
â”‚   â””â”€â”€ POST   /:id/email       (email report)
â”‚
â”œâ”€â”€ /ai-config
â”‚   â”œâ”€â”€ GET    /                (get config)
â”‚   â”œâ”€â”€ PUT    /                (update config)
â”‚   â”œâ”€â”€ POST   /test            (test connection)
â”‚   â””â”€â”€ GET    /models          (list available models)
â”‚
â”œâ”€â”€ /ai
â”‚   â”œâ”€â”€ POST   /generate-stories   (AI story generation)
â”‚   â”œâ”€â”€ POST   /refine-story       (AI story refinement)
â”‚   â””â”€â”€ POST   /estimate-points    (AI estimation)
â”‚
â”œâ”€â”€ /azure-devops
â”‚   â”œâ”€â”€ POST   /connect            (setup connection)
â”‚   â”œâ”€â”€ GET    /projects           (list projects)
â”‚   â”œâ”€â”€ POST   /test               (test connection)
â”‚   â”œâ”€â”€ GET    /status             (check status)
â”‚   â”œâ”€â”€ POST   /sync               (trigger sync)
â”‚   â”œâ”€â”€ GET    /sync-status        (sync results)
â”‚   â”œâ”€â”€ GET    /conflicts          (list conflicts)
â”‚   â””â”€â”€ POST   /resolve-conflict   (resolve conflict)
â”‚
â”œâ”€â”€ /settings
â”‚   â”œâ”€â”€ GET    /                   (get all settings)
â”‚   â”œâ”€â”€ PUT    /                   (update settings)
â”‚   â””â”€â”€ POST   /reset              (reset to defaults)
â”‚
â”œâ”€â”€ /activity
â”‚   â”œâ”€â”€ GET    /my-activity        (user's activity)
â”‚   â”œâ”€â”€ GET    /my-login-history   (login history)
â”‚   â”œâ”€â”€ GET    /my-summary         (30-day summary)
â”‚   â””â”€â”€ GET    /all                (admin: all activities)
â”‚
â””â”€â”€ /admin
    â”œâ”€â”€ /users
    â”‚   â”œâ”€â”€ GET    /
    â”‚   â”œâ”€â”€ POST   /
    â”‚   â”œâ”€â”€ PUT    /:id
    â”‚   â””â”€â”€ DELETE /:id
    â”‚
    â””â”€â”€ /audit-logs
        â””â”€â”€ GET    /
```

---

## 6. AUTHENTICATION & SECURITY FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AUTHENTICATION & SESSION FLOW                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LOGIN SEQUENCE:
â•â•â•â•â•â•â•â•â•â•â•â•â•

User             Frontend          Backend            Database
  â”‚                 â”‚                â”‚                  â”‚
  â”œâ”€ Enter creds    â”‚                â”‚                  â”‚
  â”‚                 â”œâ”€ POST /auth/... â”‚                  â”‚
  â”‚                 â”‚  login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                 â”‚ (email, pwd)    â”‚                  â”‚
  â”‚                 â”‚                 â”œâ”€ Find user â”€â”€â”€â”€â”€â”¤
  â”‚                 â”‚                 â”‚ by email         â”‚
  â”‚                 â”‚                 â”‚ â—„â”€ User data â—„â”€â”€â”€â”¤
  â”‚                 â”‚                 â”‚                  â”‚
  â”‚                 â”‚                 â”œâ”€ Hash password   â”‚
  â”‚                 â”‚                 â”‚ (bcryptjs)       â”‚
  â”‚                 â”‚                 â”‚                  â”‚
  â”‚                 â”‚                 â”œâ”€ Compare hashes  â”‚
  â”‚                 â”‚                 â”‚                  â”‚
  â”‚                 â”‚                 â”œâ”€ If valid:       â”‚
  â”‚                 â”‚                 â”‚  - Generate JWT  â”‚
  â”‚                 â”‚                 â”‚  - Create sessionâ”‚
  â”‚                 â”‚                 â”‚  - INSERT session â”€â”¤
  â”‚                 â”‚                 â”‚    to DB         â”‚
  â”‚                 â”‚                 â”‚                  â”‚
  â”‚                 â”‚ â—„â”€ JWT Token â—„â”€â”€â”¤                  â”‚
  â”‚                 â”‚ + Refresh Token  â”‚                  â”‚
  â”‚                 â”‚                  â”‚                  â”‚
  â”œâ”€ Store Token    â”‚                  â”‚                  â”‚
  â”‚ in localStorage â”‚                  â”‚                  â”‚
  â”‚                 â”‚                  â”‚                  â”‚


API REQUEST SEQUENCE (with auth):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Subsequent        Frontend              Middleware         Controller
Request             â”‚                      â”‚                  â”‚
  â”‚                 â”œâ”€ GET /api/.. â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                 â”‚ + JWT in header     â”‚ â”œâ”€ Extract JWT  â”‚
  â”‚                 â”‚ (Authorization: ...) â”‚ â”‚                  â”‚
  â”‚                 â”‚                      â”‚ â”œâ”€ Verify JWT   â”‚
  â”‚                 â”‚                      â”‚ â”‚ (secret key)   â”‚
  â”‚                 â”‚                      â”‚ â”‚                  â”‚
  â”‚                 â”‚                      â”‚ â”œâ”€ Decode user  â”‚
  â”‚                 â”‚                      â”‚ â”‚ data           â”‚
  â”‚                 â”‚                      â”‚ â”‚                  â”‚
  â”‚                 â”‚                      â”‚ â”œâ”€ Attach to    â”‚
  â”‚                 â”‚                      â”‚ â”‚ req.user       â”‚
  â”‚                 â”‚                      â”‚ â”‚                  â”‚
  â”‚                 â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                 â”‚                      â”‚                â”‚ â”œâ”€ Check
  â”‚                 â”‚                      â”‚                â”‚ â”‚ permissions
  â”‚                 â”‚                      â”‚                â”‚ â”‚
  â”‚                 â”‚                      â”‚                â”‚ â”œâ”€ Execute
  â”‚                 â”‚                      â”‚                â”‚ â”‚ business
  â”‚                 â”‚                      â”‚                â”‚ â”‚ logic
  â”‚                 â”‚                      â”‚                â”‚ â”‚
  â”‚                 â”‚ â—„â”€ Response â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                 â”‚ (data)              â”‚                â”‚
  â”‚                 â”‚                      â”‚                â”‚
  â””â”€ Display data  â”‚                      â”‚                â”‚
```

---

## 7. MODULE INTERACTION MAP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MODULE INTERACTION DIAGRAM                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard   â”‚ â—„â”€â”€â”€â”€ Aggregates stats from all modules
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  User Stories    â”‚ â—„â”€â”€â”€ Primary content module
     â”‚            â”‚  Management      â”‚
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚            â”‚ BRD Module   â”‚ â—„â”€â”€â”€ Generated from stories
     â”‚                   â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚
     â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                â”‚ Azure DevOps     â”‚ â—„â”€â”€â”€ Syncs stories
     â”‚                                â”‚ Integration      â”‚
     â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  Templates   â”‚ â—„â”€â”€â”€ Used by all modules
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  Diagrams &      â”‚ â—„â”€â”€â”€ Visualizes workflows
     â”‚            â”‚  Workflows       â”‚
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  Documents   â”‚ â—„â”€â”€â”€ Central repository
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  Reports &       â”‚ â—„â”€â”€â”€ Analytics on all data
     â”‚            â”‚  Analytics       â”‚
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            â”‚  AI Config   â”‚ â—„â”€â”€â”€ Powers story & BRD generation
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Settings    â”‚ â—„â”€â”€â”€ User preferences
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


DATA FLOW BETWEEN MODULES:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AI Config â”€â”€â”€â”
            â”œâ”€â”€â–º User Stories Generation â”€â”€â”
            â”‚    (AI Service)              â”‚
            â”‚                              â”œâ”€â”€â–º BRD Module
            â””â”€â”€â–º BRD Generation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 (AI Service)

User Stories â”€â”€â”
               â”œâ”€â”€â–º Azure DevOps Sync â”€â”€â”
               â”‚                        â”œâ”€â”€â–º Azure DevOps
               â””â”€â”€â–º Diagram Builder â”€â”€â”€â”˜

Templates â”€â”€â”€â”€â”€â”€â”€â”€â–º Used in Stories, BRD, Documents

Documents â”€â”€â”€â”€â”€â”€â”€â”€â–º Referenced in Stories, BRD
```

---

## 8. DEPLOYMENT ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             DEPLOYMENT ARCHITECTURE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LOCAL DEVELOPMENT:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your Machine
â”‚
â”œâ”€â”€ Backend Container (Optional)
â”‚   â”œâ”€â”€ Node.js
â”‚   â”œâ”€â”€ Express.js
â”‚   â”œâ”€â”€ SQLite (database.db)
â”‚   â””â”€â”€ Port: 3001
â”‚
â”œâ”€â”€ Frontend Container (Optional)
â”‚   â”œâ”€â”€ Next.js
â”‚   â”œâ”€â”€ React
â”‚   â”œâ”€â”€ Tailwind CSS
â”‚   â””â”€â”€ Port: 3000
â”‚
â””â”€â”€ Direct Execution
    â”œâ”€â”€ npm run dev (backend)
    â””â”€â”€ npm run dev (frontend)


PRODUCTION (Recommended):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Cloud Provider (AWS/Azure/GCP)
â”‚
â”œâ”€â”€ Container Registry
â”‚   â”œâ”€â”€ Backend Image (Dockerfile)
â”‚   â””â”€â”€ Frontend Image (Dockerfile)
â”‚
â”œâ”€â”€ Container Orchestration (Docker Compose / Kubernetes)
â”‚   â”‚
â”‚   â”œâ”€â”€ Backend Service
â”‚   â”‚   â”œâ”€â”€ Node.js + Express
â”‚   â”‚   â”œâ”€â”€ Multiple Replicas (load balanced)
â”‚   â”‚   â””â”€â”€ Database: PostgreSQL (managed)
â”‚   â”‚
â”‚   â””â”€â”€ Frontend Service
â”‚       â”œâ”€â”€ Next.js (optimized build)
â”‚       â”œâ”€â”€ CDN (CloudFront / CloudFlare)
â”‚       â””â”€â”€ Multiple Replicas
â”‚
â”œâ”€â”€ Database
â”‚   â”œâ”€â”€ PostgreSQL (production)
â”‚   â”œâ”€â”€ Backup: Automated daily
â”‚   â””â”€â”€ Replication: Multi-region
â”‚
â”œâ”€â”€ External Services
â”‚   â”œâ”€â”€ OpenAI API
â”‚   â”œâ”€â”€ Azure DevOps API
â”‚   â””â”€â”€ Email Service (SendGrid/SES)
â”‚
â””â”€â”€ Monitoring & Logging
    â”œâ”€â”€ CloudWatch / ELK
    â”œâ”€â”€ Error Tracking (Sentry)
    â””â”€â”€ Performance Monitoring (DataDog)
```

---

## 9. SECURITY ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SECURITY ARCHITECTURE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NETWORK SECURITY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â”‚
    â”œâ”€â”€ HTTPS/TLS
    â”‚   â””â”€â”€ All traffic encrypted
    â”‚
    â”œâ”€â”€ CORS Protection
    â”‚   â””â”€â”€ Only whitelisted origins
    â”‚
    â””â”€â”€ DDoS Protection
        â””â”€â”€ CloudFlare / WAF


APPLICATION SECURITY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â”‚
    â”œâ”€â”€ Authentication
    â”‚   â”œâ”€â”€ JWT tokens (expiring)
    â”‚   â”œâ”€â”€ Secure refresh tokens
    â”‚   â””â”€â”€ HTTPS only transmission
    â”‚
    â”œâ”€â”€ Authorization
    â”‚   â”œâ”€â”€ Role-Based Access Control (RBAC)
    â”‚   â””â”€â”€ Permission checking on all endpoints
    â”‚
    â”œâ”€â”€ Data Protection
    â”‚   â”œâ”€â”€ Sensitive fields encrypted (AES-256)
    â”‚   â”‚   â”œâ”€â”€ API keys (OpenAI, Azure)
    â”‚   â”‚   â”œâ”€â”€ Password reset tokens
    â”‚   â”‚   â””â”€â”€ Database encryption at rest
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Password Security
    â”‚   â”‚   â”œâ”€â”€ Bcrypt hashing (salt rounds: 12)
    â”‚   â”‚   â”œâ”€â”€ Min 8 characters
    â”‚   â”‚   â””â”€â”€ Password strength validation
    â”‚   â”‚
    â”‚   â””â”€â”€ 2FA
    â”‚       â”œâ”€â”€ TOTP-based (30-sec codes)
    â”‚       â””â”€â”€ Backup codes (10 codes per user)
    â”‚
    â”œâ”€â”€ Input Validation
    â”‚   â”œâ”€â”€ Server-side validation (express-validator)
    â”‚   â”œâ”€â”€ SQL injection prevention (parameterized queries)
    â”‚   â””â”€â”€ XSS prevention (input sanitization)
    â”‚
    â””â”€â”€ Logging & Audit
        â”œâ”€â”€ All actions logged (audit_logs table)
        â”œâ”€â”€ IP address tracking
        â”œâ”€â”€ User agent recording
        â””â”€â”€ Tamper-proof logging


SECRETS MANAGEMENT:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â”‚
    â”œâ”€â”€ Environment Variables (.env)
    â”‚   â”œâ”€â”€ JWT_SECRET (never commit)
    â”‚   â”œâ”€â”€ OPENAI_API_KEY
    â”‚   â”œâ”€â”€ DATABASE_URL
    â”‚   â””â”€â”€ AZURE_DEVOPS_PAT
    â”‚
    â””â”€â”€ Encryption at Rest
        â”œâ”€â”€ API keys encrypted before storage
        â””â”€â”€ Sensitive data in encrypted fields
```

---

## 10. PERFORMANCE & SCALABILITY

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PERFORMANCE & SCALABILITY ARCHITECTURE          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FRONTEND OPTIMIZATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Next.js Features:
â”œâ”€â”€ Static Generation (SSG)
â”œâ”€â”€ Server-Side Rendering (SSR)
â”œâ”€â”€ Incremental Static Regeneration (ISR)
â”œâ”€â”€ Image Optimization
â”œâ”€â”€ Code Splitting
â””â”€â”€ Lazy Loading

Caching:
â”œâ”€â”€ Browser Cache (static assets)
â”œâ”€â”€ CDN Cache (CloudFront)
â””â”€â”€ Service Worker (offline support)


BACKEND OPTIMIZATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Database:
â”œâ”€â”€ Indexed queries (on frequently searched columns)
â”œâ”€â”€ Connection pooling
â”œâ”€â”€ Query optimization
â””â”€â”€ SQLite â†’ PostgreSQL (when scaling)

API Response:
â”œâ”€â”€ Pagination (default 50 items)
â”œâ”€â”€ Response compression (gzip)
â”œâ”€â”€ Rate limiting (prevent abuse)
â””â”€â”€ Request timeout (30 seconds)

Caching:
â”œâ”€â”€ Redis (session cache)
â”œâ”€â”€ In-memory cache (frequently accessed data)
â””â”€â”€ API response cache (configurable TTL)


SCALABILITY STRATEGY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Phase 1 (Current: 100 users):
â”œâ”€â”€ Single Backend Instance
â”œâ”€â”€ SQLite Database
â””â”€â”€ Shared file storage

Phase 2 (1,000 users):
â”œâ”€â”€ Load-Balanced Backend (2-3 instances)
â”œâ”€â”€ PostgreSQL Database
â””â”€â”€ Database connection pooling

Phase 3 (10,000+ users):
â”œâ”€â”€ Kubernetes Cluster
â”œâ”€â”€ PostgreSQL with replication
â”œâ”€â”€ Redis for session/cache
â”œâ”€â”€ Separate file server (S3)
â”œâ”€â”€ CDN for static assets
â””â”€â”€ Microservices (if needed)
```

---

**Document Generated:** January 4, 2026  
**Architecture Version:** 1.0  
**Last Updated:** Ready for Implementation
